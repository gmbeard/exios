Fixes a deadlock that can happend when io-based and non-io-based operations are queued
